<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>360 Player | The Briefing &mdash; Segment Testing | AlbertMohler.com</title>
    <link rel="stylesheet" type="text/css" href="css/360player.css" />
    <style>
        .section{display:block;background-color:white;padding:15px;margin:5px 10px;}
        .section.playing{background-color:goldenrod;}
        .ui360 .sm2-360ui.sm2_playing .sm2-timing{visibility:hidden;}
        .ui360 .sm2-360ui.sm2_playing .sm2-360btn,
        .ui360 .sm2-360ui.sm2_playing .sm2-360btn{
            background:transparent url(img/360-button-pause-light.png) no-repeat 50% 50%;
            background-image: none, url(img/360-button-pause-light-2x.png);
            background-size: 22px 22px;
            _background:transparent url(img/360-button-pause-light.gif) no-repeat 50% 50%;
            cursor:pointer;
        }
    </style>
    <!-- special IE-only canvas fix -->
    <!--[if IE]><script type="text/javascript" src="js/excanvas.js"></script><![endif]-->
</head>
<body>
    <div class="player ui360">
        <a class="briefing" type="mp3" href="http://4ff414ae5107de3a9e18-43dbab4d73aa8c295e652f2d85e793bd.r77.cf1.rackcdn.com/media/audio/totl/Podcast/20150826_TheBriefing1.mp3">August 26th</a>
    </div>
    <div>
        <p>Sections</p>
        <ol>
            <li><a class="section" data-begin="0" data-end="13" href="#section01">Intro</a></li>
            <li><a class="section" data-begin="13" data-end="777" href="#section02">Threat of National Cathedral collapse parable of religion in postmodern America</a></li>
            <li><a class="section" data-begin="778" data-end="1128" href="#section03">Harvard prof argues no moral imperative in bioethics other than progress</a></li>
            <li><a class="section" data-begin="1129" data-end="99999999" href="#section04">Outtro</a></li>
        </ol>
    </div>
    <p><a target="_blank" href="http://www.schillmania.com/projects/soundmanager2/demo/360-player/">Using 360 UI for SoundManager</a></p>
    <script src="js/berniecode-animator.js"></script>
    <script src="js/soundmanager2-nodebug-jsmin.js"></script>
    <script src="js/360player-class.js"></script>
<script>
    (function (win, doc, sm, ThreeSixtyPlayer) {
        /*
         * threeSixtyPlayer augmentation variables to save original functions
        */
        var originalPlaying, originalFinish;
        /*
         * our variables
        */
        var theBriefing = doc.querySelector('.briefing'),
            sections = Array.prototype.slice.call(doc.querySelectorAll('.section'));

        /*
         * our functions
        */
        function ready() {
            sections.forEach(addSection);
        }
        function addSection(currentVal, index, wholeArr) {
            currentVal.addEventListener('click', playSection.bind(currentVal));
        }
        function playSection(e) {
            var s = threeSixtyPlayer.getSoundByURL(theBriefing.href),
                begin = parseInt(this.getAttribute('data-begin'), 10) * 1000,
                end = parseInt(this.getAttribute('data-end'), 10) * 1000;
            e.preventDefault();
            if (s) {
                s.stop();
            } else {
                threeSixtyPlayer.handleClick({target:theBriefing,preventDefault:function(){}});
                s = threeSixtyPlayer.getSoundByURL(theBriefing.href);
            }
            continuePlay(s, {
                from: begin,
                to: end
            });
        }
        function continuePlay(s, options) {
            options = options || {};
            s.play(options);
        }
        function highlightSection(time) {
            sections.forEach(function (currentVal, index, wholeArr) {
                var begin = parseInt(currentVal.getAttribute('data-begin'), 10),
                    end = parseInt(currentVal.getAttribute('data-end'), 10);
                if ((time >= begin) && (time < end)) {
                    currentVal.classList.add('playing');
                } else {
                    currentVal.classList.remove('playing');
                }
            });
        }
        function playing() {
            var time = Math.floor(this.position / 1000);
            highlightSection(time);
            originalPlaying.apply(this);
        }
        function finished() {
            playingSection = false;
            highlightSection(-1);
            originalFinish.apply(this);
        }

        // initialize ThreeSixtyPlayer
        threeSixtyPlayer = new ThreeSixtyPlayer();
        /*
         * save threeSixtyPlayer event functions
        */
        originalPlaying = threeSixtyPlayer.events.whileplaying;
        originalFinish = threeSixtyPlayer.events.finish;
        /*
         * augment threeSixtyPlayer object
        */
        threeSixtyPlayer.events.whileplaying = playing;
        threeSixtyPlayer.events.finish = finished;

        // connect threeSixtyPlayer to soundManager along with our own ready()
        sm.onready(function () {
            // hook into SM2 init
            threeSixtyPlayer.init();

            // our ready hook
            ready();
        });

        // setup soundManager
        sm.setup({
            url: '/360/swf/'
        });
}(window, document, soundManager, window.ThreeSixtyPlayer));
</script>
</body>
</html>
